<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Защищённый аудиогид</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background: #f5f5f5;
        }

        .player-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin: 20px 0;
        }

        .player-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .track-info {
            flex-grow: 1;
        }

        .track-title {
            color: #2c3e50;
            margin: 0;
            font-size: 1.2em;
        }

        .track-duration {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .custom-player {
            width: 100%;
            position: relative;
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        button {
            background: #3498db;
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: #2980b9;
        }

        input[type="range"] {
            flex-grow: 1;
            height: 4px;
            background: #ddd;
            border-radius: 2px;
        }

        .time-display {
            font-size: 0.9em;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <!-- Основная дорожка -->
    <div class="player-card">
        <div class="player-header">
            <div class="track-info">
                <div class="track-title">1. Основная экскурсия</div>
                <div class="track-duration">45 минут</div>
            </div>
        </div>
        <div class="custom-player">
            <div class="controls">
                <button id="playPause">▶</button>
                <input type="range" id="progress" value="0">
                <div class="time-display" id="time">0:00 / 45:00</div>
            </div>
        </div>
    </div>

    <script>
        // Защита контента
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('keydown', e => {
            if (e.ctrlKey && (e.key === 's' || e.key === 'u')) e.preventDefault();
        });

        // Кастомный плеер
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let audioBuffer;
        let audioSource;
        let isPlaying = false;
        let startTime;
        let pauseTime = 0;

        // Загрузка аудио
        fetch('https://raw.githubusercontent.com/shirlyskar/audio-guide/main/audio/anna.mp3')
            .then(response => response.arrayBuffer())
            .then(data => audioContext.decodeAudioData(data))
            .then(buffer => {
                audioBuffer = buffer;
            });

        // Управление воспроизведением
        document.getElementById('playPause').addEventListener('click', () => {
            if (!isPlaying) {
                startTime = audioContext.currentTime - pauseTime;
                audioSource = audioContext.createBufferSource();
                audioSource.buffer = audioBuffer;
                audioSource.connect(audioContext.destination);
                audioSource.start(0, pauseTime);
                isPlaying = true;
                document.getElementById('playPause').textContent = '⏸';
            } else {
                pauseTime = audioContext.currentTime - startTime;
                audioSource.stop();
                isPlaying = false;
                document.getElementById('playPause').textContent = '▶';
            }
        });

        // Обновление прогресса
        setInterval(() => {
            if (isPlaying) {
                const currentTime = audioContext.currentTime - startTime;
                const progress = (currentTime / audioBuffer.duration) * 100;
                document.getElementById('progress').value = progress;
                
                // Форматирование времени
                const formatTime = (seconds) => {
                    const mins = Math.floor(seconds / 60);
                    const secs = Math.floor(seconds % 60);
                    return `${mins}:${secs.toString().padStart(2, '0')}`;
                };
                
                document.getElementById('time').textContent = 
                    `${formatTime(currentTime)} / ${formatTime(audioBuffer.duration)}`;
            }
        }, 500);
    </script>
</body>
</html>
